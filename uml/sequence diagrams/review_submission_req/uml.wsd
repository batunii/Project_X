@startuml
title Review a Submission Request

actor "Signed-in User" as User
participant "HUD" as HUD
participant "Security Manager" as Sec
participant "Profile Manager" as Prof
participant "Network Manager" as Net
participant "Room Manager (incl. submissions)" as Room
participant "Canvas (Artwork Loader/Store)" as Canvas
participant "Collaboration/Communication" as Collab
participant "Event Logger" as Log
actor "Artist (Submitter)" as Artist

' ============== TRIGGER ==============
User ->> HUD: Click "Review" on submission notification
HUD ->> Sec: Verify session/auth
Sec --> HUD: Auth OK (user owns gallery)
Log --> Log: Log: SubmissionReview.Open

' ============== LOAD SUBMISSION DETAILS ==============
HUD ->> Room: Get pending submission details (submissionId)
Room ->> Canvas: Fetch artwork preview/meta (title, artists, desc)
Canvas --> Room: Artwork meta + preview ref
Room --> HUD: Submission details
HUD --> User: Show artwork, title, artists, description\nShow Accept / Reject buttons
Log --> Log: Log: SubmissionReview.DetailsShown

' ============== DECISION BRANCH ==============
alt User clicks "Accept"
  HUD ->> HUD: Prompt message textbox for feedback
  User ->> HUD: Enter acceptance message + Send
  Log --> Log: Log: SubmissionReview.AcceptClicked

  ' Apply change to gallery
  HUD ->> Room: Approve submission(submissionId)
  Room ->> Canvas: Add artwork to gallery (place/slot, metadata)
  Canvas --> Room: Added OK (asset id / placement)
  Room ->> Net: Broadcast gallery update (artwork added)
  Net --> HUD: Update gallery view (new artwork visible)
  Log --> Log: Log: SubmissionReview.ArtworkAdded

  ' Notify artist
  HUD ->> Collab: Send acceptance message to artist
  Collab --> Artist: Notification: Submission accepted + feedback
  Log --> Log: Log: SubmissionReview.AcceptanceNotified

  HUD --> User: Confirmation: Artwork added to your gallery
else User clicks "Reject"
  HUD ->> HUD: Prompt message textbox for feedback
  User ->> HUD: Enter rejection message + Send
  Log --> Log: Log: SubmissionReview.RejectClicked

  ' Mark as rejected (no gallery change)
  HUD ->> Room: Reject submission(submissionId)
  Room --> HUD: Marked rejected
  Log --> Log: Log: SubmissionReview.MarkedRejected

  ' Notify artist
  HUD ->> Collab: Send rejection notice + feedback
  Collab --> Artist: Notification: Submission rejected + feedback
  HUD --> User: Confirmation: Rejection sent to artist
end

' ============== POST INTERACTION (COMMON) ==============
par UI Refresh
  HUD ->> Room: Refresh pending submissions list
  Room --> HUD: Updated queue
else Telemetry
  Log --> Log: Log: SubmissionReview.Completed
end

' ============== NOTES ==============
note over HUD
Trigger: Notification on gallery page indicates a pending submission.
User clicks "Review".
end note

note over Sec
Precondition: A user (artist) has submitted artwork to this gallery.
Only signed-in owners can review.
end note

note over Collab
Special Requirement: Notification system for requests and feedback.
end note

note over Room, Canvas
Postconditions (Accept): Artwork is added to the gallery.
Postconditions (Reject): Artwork not added; artist receives feedback.
end note

@enduml
